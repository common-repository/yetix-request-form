!function(e){const{__:i,_x:t,_n:d,_nx:l,sprintf:a}=wp.i18n;function s(i){var t=function(i){var t=new FormData(i);return e(i).find("input[type=checkbox]").each(function(){t.append(e(this).attr("name"),e(this).is(":checked")?"true":"false")}),t}(i);!function(i){e(i).addClass("loading")}(i),function(i){e(i).find("button,input,textarea,select").prop("disabled",!0)}(i),e.ajax({url:yetix.save_settings_api_url,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",yetix.nonce)},method:"POST",data:t,processData:!1,contentType:!1,cache:!1,success:function(e){v(i),u(i),p(e.code,e.message),n()},error:function(e){v(i),u(i),p(e.responseJSON.code,e.responseJSON.message,!0),n()}})}function n(){var i;i=e("#yetix_request__status"),e(i).addClass("loading"),e.ajax({url:yetix.check_connection_api_url,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",yetix.nonce)},method:"GET",success:function(t){c(i,t.code,t.message),o(),e(i).removeClass("loading")},error:function(t){c(i,t.responseJSON.code,t.responseJSON.message),o(),e(i).removeClass("loading")}})}function o(){var i;i=e("#yetix_request__ticket_fields_settings"),e(i).addClass("loading"),e.ajax({url:yetix.load_ticket_fields_api_url,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",yetix.nonce)},method:"GET",success:function(t){r(i,t.code,t.message,t.fields,t.options),e(i).removeClass("loading")},error:function(t){r(i,t.responseJSON.code,t.responseJSON.message),e(i).removeClass("loading")}})}function c(t,d,l){var a=e('<table class="form-table" role="presentation"><tbody></tbody></table>'),s=e('<tr class="ui message '+d+'"></tr>'),n=e('<th scope="row">'+i("Current connection status","yetix-request-form")+"</th>"),o=e("<td>"+l+"</td>");s.append([n,o]),a.find("tbody").append(s),e(t).html(a)}function r(t,d,l,n=null,o=null){var c=e("");if("zendesk_ticket_fields_load"===d){var r={type_labels:{subject:i("Text","yetix-request-form"),tickettype:i("Ticket type","yetix-request-form"),tagger:i("Dropdown list","yetix-request-form"),description:i("Description","yetix-request-form"),textarea:i("Multiline","yetix-request-form"),status:i("Status","yetix-request-form"),priority:i("Priority","yetix-request-form"),text:i("Text","yetix-request-form"),date:i("Date","yetix-request-form"),group:i("Group","yetix-request-form"),assignee:i("Assignee","yetix-request-form"),multiselect:i("Multiselect Dropdown list","yetix-request-form"),decimal:i("Decimal","yetix-request-form"),partialcreditcard:i("Credit card","yetix-request-form"),checkbox:i("Checkbox","yetix-request-form"),integer:i("Numeric","yetix-request-form"),regexp:i("Regular expression","yetix-request-form")}},p=e("<h2>"+i("Zendesk ticket fields","yetix-request-form")+"</h2>"),u=(c=e('<form id="yetix_request__ticket_fields_settings_form" class="yetix__development__settings_form ui form"></form>'),e('<p class="description">'+i("Set default fields settings.","yetix-request-form")+"</p>")),v=e('<table class="yetix_request__settings_field_board ui very basic table"></table>'),f=e('<thead><tr><th class="th-name">'+i("Name","yetix-request-form")+'</th><th class="th-type aligned">'+i("Type","yetix-request-form")+'</th><th class="th-format aligned">'+i("Format","yetix-request-form")+'</th><th class="th-display center aligned">'+i("Display","yetix-request-form")+'</th><th class="th-required center aligned">'+i("Required","yetix-request-form")+"</th></tr></thead>"),m=e('<tbody class="ui accordion"></tbody>'),_=e('<p class="submit"><input type = "submit" name = "submit" id="yetix_request__submit_ticket_fields_settings" class="button button-primary" value="'+i("Save settings","yetix-request-form")+'"></input></p>'),y=' onclick="return false;"',b=' checked="checked"',h='<i class="lock icon"></i> ',x='<i class="handle grip vertical icon"></i>',g=' disabled="disabled"',k=[],z=e('<tr class="the-field"></tr>'),N=e('<td colspan="5"></td>'),q=e('<div class="title"></div>'),w=e('<div class="td-field-name">'+x+'<div class="field-name-clicker"><i class="icon dropdown"></i><strong>'+i("Name","yetix-request-form")+"</strong>"+h+"</div></div>"),S=e('<div class="td-field-type aligned"><div class="field-name-type"><div class="field-type ui horizontal label">'+i("System","yetix-request-form")+"</div><div></div>"),C=e('<div class="td-field-format aligned"><div class="field-format ui horizontal label">'+i("Text","yetix-request-form")+"</div></div>"),D=e('<div class="td-field-display center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_name_field][display]" value="true"'+b+y+g+"><label></label></div></div>"),T=e('<div class="td-field-required center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_name_field][required]" value="true"'+b+y+g+"><label></label></div></div>"),O=e('<div class="content"></div>'),j=e('<div class="field"><label>'+i("Overwrite label","yetix-request-form")+'</label><input type="text" name="options[zendesk_name_field][label]" value="'+o.name_field.label+'"></div>'),J=e('<div class="field"><label>'+i("Default value","yetix-request-form")+'</label><input type="text" name="options[zendesk_name_field][default]" value="'+o.name_field.default+'"></div>'),E=e('<input type="hidden" class="order" name="options[zendesk_name_field][order]" value="'+o.name_field.order+'">');q.append([w,S,C,D,T]),O.append([j,J,E]),N.append([q,O]),z.append([N]),k.push(z);z=e('<tr class="the-field"></tr>'),N=e('<td colspan="5"></td>'),q=e('<div class="title"></div>'),w=e('<div class="td-field-name">'+x+'<div class="field-name-clicker"><i class="icon dropdown"></i><strong>'+i("Email","yetix-request-form")+"</strong>"+h+"</div></div>"),S=e('<div class="td-field-type aligned"><div class="field-name-origin"><div class="field-origin ui horizontal label">'+i("System","yetix-request-form")+"</div><div></div>"),C=e('<div class="td-field-format aligned"><div class="field-format ui horizontal label">'+i("Email","yetix-request-form")+"</div></div>"),D=e('<div class="td-field-display center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_name_field][display]" value="true"'+b+y+g+"><label></label></div></div>"),T=e('<div class="td-field-required center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_email_field][required]" value="true"'+b+y+g+"><label></label></div></div>"),O=e('<div class="content"></div>'),j=e('<div class="field"><label>'+i("Overwrite label","yetix-request-form")+'</label><input type="text" name="options[zendesk_email_field][label]" value="'+o.email_field.label+'"></div>'),J=e('<div class="field"><label>'+i("Default value","yetix-request-form")+'</label><input type="text" name="options[zendesk_email_field][default]" value="'+o.email_field.default+'"></div>'),E=e('<input type="hidden" class="order" name="options[zendesk_email_field][order]" value="'+o.email_field.order+'">');q.append([w,S,C,D,T]),O.append([j,J,E]),N.append([q,O]),z.append([N]),k.push(z);var P="true"===o.attachment_field.display?b:"",R="true"===o.attachment_field.required?b:"",A=(z=e('<tr class="the-field"></tr>'),N=e('<td colspan="5"></td>'),q=e('<div class="title"></div>'),w=e('<div class="td-field-name">'+x+'<div class="field-name-clicker"><i class="icon dropdown"></i><strong>'+i("Attachment","yetix-request-form")+"</strong></div></div>"),S=e('<div class="td-field-type aligned"><div class="field-name-origin"><div class="field-origin ui horizontal label">'+i("System","yetix-request-form")+"</div><div></div>"),C=e('<div class="td-field-format aligned"><div class="field-format ui horizontal label">'+i("Attachment","yetix-request-form")+"</div></div>"),D=e('<div class="td-field-display center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_attachment_field][display]" value="true"'+P+"><label></label></div></div>"),T=e('<div class="td-field-required center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_attachment_field][required]" value="true"'+R+"><label></label></div></div>"),O=e('<div class="content"></div>'),j=e('<div class="field"><label>'+i("Overwrite label","yetix-request-form")+'</label><input type="text" name="options[zendesk_attachment_field][label]" value="'+o.attachment_field.label+'">'),e('<div class="field"><div class="ui right labeled input"><label class="ui label">'+i("Maximum file size","yetix-request-form")+'</label><input type="text" name="options[zendesk_attachment_field][max_size]" value="'+o.attachment_field.max_size+'"><div class="ui label">'+a(i("Bytes ( %s max )","yetix-request-form"),yetix.max_upload_size)+"</div></div>")),G=e('<div class="field"><label>'+i("Allowed file extensions list","yetix-request-form")+'</label><textarea name="options[zendesk_attachment_field][allowed_ext]">'+o.attachment_field.allowed_ext+"</textarea>");E=e('<input type="hidden" class="order" name="options[zendesk_attachment_field][order]" value="'+o.attachment_field.order+'">');q.append([w,S,C,D,T]),O.append([j,A,G,E]),N.append([q,O]),z.append([N]),k.push(z),n.forEach(function(t){if(t.active&&!["group","assignee","partialcreditcard"].includes(t.type)){null==o.custom_fields[t.id]&&(o.custom_fields[t.id]={display:!1,label:"",default:""}),null==o.custom_fields[t.id].display&&(o.custom_fields[t.id].display=""),null==o.custom_fields[t.id].label&&(o.custom_fields[t.id].label=""),null==o.custom_fields[t.id].default&&(o.custom_fields[t.id].default="");var d=t.is_system?i("System","yetix-request-form"):i("Custom","yetix-request-form"),l=!!["subject","description"].includes(t.type),a=l?' disabled="disabled"':"",s=l?h:"",n="true"===o.custom_fields[t.id].display||l?b:"",c="true"===o.custom_fields[t.id].required||l?b:"",p=l?y:"",u=e('<tr class="the-field"></tr>'),v=e('<td colspan="5"></td>'),f=e('<div class="title"></div>'),m=e('<div class="td-field-name">'+x+'<div class="field-name-clicker"><i class="icon dropdown"></i><strong>'+t.title+"</strong>"+s+"</div></div>"),_=e('<div class="td-field-type aligned"><div class="field-name-origin"><div class="field-origin ui horizontal label">'+d+"</div><div></div>"),g=e('<div class="td-field-format aligned"><div class="field-format ui horizontal label">'+r.type_labels[t.type]+"</div></div>"),z=e('<div class="td-field-display center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_fields]['+t.id+'][display]" value="true"'+n+a+p+"><label></label></div></div>"),N=e('<div class="td-field-required center aligned"><div class="ui toggle fitted checkbox"><input type="checkbox" name="options[zendesk_fields]['+t.id+'][required]" value="true"'+c+a+p+"><label></label></div></div>"),q=e('<div class="content"></div>'),w=e('<div class="field"><label>'+i("Overwrite label","yetix-request-form")+'</label><input type="text" name="options[zendesk_fields]['+t.id+'][label]" value="'+o.custom_fields[t.id].label+'"></div>'),S=["multiselect","checkbox","partialcreditcard","group","assignee","tagger","status","tickettype","priority","date"].includes(t.type)?e(""):e('<div class="field"><label>'+i("Default value","yetix-request-form")+'</label><input type="text" name="options[zendesk_fields]['+t.id+'][default]" value="'+o.custom_fields[t.id].default+'"></div>'),C=e('<input type="hidden" class="order" name="options[zendesk_fields]['+t.id+'][order]" value="'+o.custom_fields[t.id].order+'">');f.append([m,_,g,z,N]),q.append([w,S,C]),v.append([f,q]),u.append([v]),k.push(u)}}),m.sortable({containment:c,item:"> tr",handle:".handle",cursor:"move",stop:function(i,t){t.item.parent().find("input.order").each(function(i){e(this).val(i.toString())})},start:function(i,t){e(t.helper).height(""),e(t.placeholder).find("td").height(e(t.helper).height())}}),k.sort(function(i,t){var d=parseInt(e(i).find("input.order").val()),l=parseInt(e(t).find("input.order").val());return isNaN(d)||isNaN(l)?isNaN(d)&&isNaN(l)?0:isNaN(d)?1:-1:d<l?-1:d>l?1:0}),m.append(k),v.append([f,m]),c.on("submit",function(e){e.preventDefault(),s(this)}),c.append([p,u,v,_]),c.find(".accordion").accordion({selector:{trigger:".field-name-clicker"}}),e(c).find("i.handle").on("mousedown",function(i){e(i.currentTarget).closest(".the-field").addClass("ready-for-drag");var t=e(c).find("tr").index(e(i.currentTarget).closest(".the-field"))-1;e(c).find(".accordion").accordion("close",t),setTimeout(function(t){e(i.currentTarget).closest(".the-field").removeClass("ready-for-drag")},400)}),e.each(c.find(".td-field-display .checkbox"),function(i,t){!1===e(t).checkbox("is checked")&&e(t).closest(".the-field").find(".td-field-required .checkbox").checkbox("disable")}),c.find(".td-field-display .checkbox").checkbox({onChecked:function(){e(this).closest(".the-field").find(".td-field-required .checkbox").checkbox("enable")},onUnchecked:function(){e(this).closest(".the-field").find(".td-field-required .checkbox").checkbox("disable")}})}e(t).html(c)}function p(i,t,d=!1){var l=e('<div class="notice"></div>'),a=(t=e("<p><strong>"+t+"</strong></p>"),e('<button type="button" class="notice-dismiss"><span class="screen-reader-text">Dismiss this notice.</span></button>'));l.append(t),l.addClass("yetix_settings_save_success"===i?"notice-success":"notice-error"),d?(l.addClass("is-dismissible"),l.append(a),a.on("click",function(){l.remove()})):setTimeout(function(){l.remove()},5555),e("#wpbody").prepend(l)}function u(i){e(i).find("button,input,textarea,select").prop("disabled",!1)}function v(i){e(i).removeClass("loading")}e("form.yetix__development__settings_form").on("submit",function(e){e.preventDefault(),s(this)}),n()}(jQuery);